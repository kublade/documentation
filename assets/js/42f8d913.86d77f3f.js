"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[62],{8453:(e,s,n)=>{n.d(s,{R:()=>o,x:()=>c});var i=n(6540);const r={},l=i.createContext(r);function o(e){const s=i.useContext(l);return i.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(l.Provider,{value:s},e.children)}},9119:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>t});const i=JSON.parse('{"id":"roles_and_permissions","title":"Roles and permissions","description":"This guide explains how roles and permissions work in the system. The permission system is designed to provide fine-grained access control for all resources.","source":"@site/docs/roles_and_permissions.md","sourceDirName":".","slug":"/roles_and_permissions","permalink":"/docs/roles_and_permissions","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6},"sidebar":"tutorialSidebar","previous":{"title":"Projects","permalink":"/docs/projects"},"next":{"title":"Advanced Authentication","permalink":"/docs/category/advanced-authentication"}}');var r=n(4848),l=n(8453);const o={sidebar_position:6},c="Roles and permissions",d={},t=[{value:"Permission Structure",id:"permission-structure",level:2},{value:"Permission Format",id:"permission-format",level:3},{value:"Resource Types",id:"resource-types",level:3},{value:"Permission Guard",id:"permission-guard",level:2},{value:"UI Permissions",id:"ui-permissions",level:3},{value:"API Permissions",id:"api-permissions",level:3},{value:"Permission Management",id:"permission-management",level:2},{value:"Syncing Permissions",id:"syncing-permissions",level:3},{value:"Permission Translation",id:"permission-translation",level:3},{value:"Role Management",id:"role-management",level:2},{value:"Built-in Roles",id:"built-in-roles",level:3},{value:"Custom Roles",id:"custom-roles",level:3},{value:"Permission Inheritance",id:"permission-inheritance",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"Examples",id:"examples",level:2},{value:"Basic Permission Examples",id:"basic-permission-examples",level:3},{value:"Role Definition Example",id:"role-definition-example",level:3},{value:"API Permissions",id:"api-permissions-1",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2}];function a(e){const s={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"roles-and-permissions",children:"Roles and permissions"})}),"\n",(0,r.jsx)(s.p,{children:"This guide explains how roles and permissions work in the system. The permission system is designed to provide fine-grained access control for all resources."}),"\n",(0,r.jsx)(s.h2,{id:"permission-structure",children:"Permission Structure"}),"\n",(0,r.jsx)(s.p,{children:"Permissions are organized in a hierarchical structure using dot notation. Each permission represents access to a specific resource or action. The system supports both UI and API permissions."}),"\n",(0,r.jsx)(s.h3,{id:"permission-format",children:"Permission Format"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"[resource].[id].[action]\n"})}),"\n",(0,r.jsx)(s.p,{children:"Where:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"resource"}),": The resource type (e.g., projects, templates, deployments)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"id"}),": (Optional) Specific resource ID or ",(0,r.jsx)(s.code,{children:"*"})," for all resources"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"action"}),": The specific action (e.g., view, create, update, delete)"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"resource-types",children:"Resource Types"}),"\n",(0,r.jsx)(s.p,{children:"The system supports the following resource types:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"projects"}),": Project management"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"templates"}),": Template management"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"folders"}),": Template directory management"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"files"}),": Template file management"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"fields"}),": Template field management"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"options"}),": Template field options"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"ports"}),": Port claim management"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"clusters"}),": Cluster management"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"deployments"}),": Deployment management"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"commits"}),": Deployment commit management"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"network-policies"}),": Network policy management"]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"permission-guard",children:"Permission Guard"}),"\n",(0,r.jsx)(s.p,{children:"The system uses middleware to enforce permissions:"}),"\n",(0,r.jsx)(s.h3,{id:"ui-permissions",children:"UI Permissions"}),"\n",(0,r.jsxs)(s.p,{children:["The ",(0,r.jsx)(s.code,{children:"PermissionGuard"})," middleware (",(0,r.jsx)(s.code,{children:"app/Http/Middleware/PermissionGuard.php"}),") handles UI permissions. It:"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Intercepts web requests"}),"\n",(0,r.jsx)(s.li,{children:"Validates user permissions"}),"\n",(0,r.jsx)(s.li,{children:"Translates permission names for display"}),"\n",(0,r.jsx)(s.li,{children:"Handles permission inheritance"}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"api-permissions",children:"API Permissions"}),"\n",(0,r.jsxs)(s.p,{children:["The ",(0,r.jsx)(s.code,{children:"API\\PermissionGuard"})," middleware (",(0,r.jsx)(s.code,{children:"app/Http/Middleware/API/PermissionGuard.php"}),") handles API permissions. It:"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Intercepts API requests"}),"\n",(0,r.jsx)(s.li,{children:"Validates API tokens and permissions"}),"\n",(0,r.jsx)(s.li,{children:"Enforces API-specific permission rules"}),"\n",(0,r.jsx)(s.li,{children:"Handles API permission inheritance"}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"permission-management",children:"Permission Management"}),"\n",(0,r.jsx)(s.h3,{id:"syncing-permissions",children:"Syncing Permissions"}),"\n",(0,r.jsx)(s.p,{children:"Permissions are automatically synced from route definitions. To manually sync permissions:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"php artisan app:sync-permissions\n"})}),"\n",(0,r.jsx)(s.p,{children:"This command:"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsx)(s.li,{children:"Scans all routes for permission middleware"}),"\n",(0,r.jsx)(s.li,{children:"Extracts permission definitions"}),"\n",(0,r.jsx)(s.li,{children:"Creates or updates permission records"}),"\n",(0,r.jsx)(s.li,{children:"Removes obsolete permissions"}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"permission-translation",children:"Permission Translation"}),"\n",(0,r.jsx)(s.p,{children:"The system automatically translates permission names for better readability. For example:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"projects.0fa0043b-6134-4f4b-a243-6b354605daa9.view"})," becomes ",(0,r.jsx)(s.code,{children:"projects.my-project.view"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"templates.11eb2826-a128-4600-b98c-2a50edfc8615.update"})," becomes ",(0,r.jsx)(s.code,{children:"templates.my-template.update"})]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"role-management",children:"Role Management"}),"\n",(0,r.jsx)(s.p,{children:"Roles are collections of permissions that can be assigned to users. The system supports:"}),"\n",(0,r.jsx)(s.h3,{id:"built-in-roles",children:"Built-in Roles"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"admin"}),": Full system access"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"user"}),": Basic user access"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"viewer"}),": Read-only access"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"custom-roles",children:"Custom Roles"}),"\n",(0,r.jsx)(s.p,{children:"You can create custom roles with specific permission sets for different use cases."}),"\n",(0,r.jsx)(s.h2,{id:"permission-inheritance",children:"Permission Inheritance"}),"\n",(0,r.jsx)(s.p,{children:"The system implements permission inheritance through wildcards:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"projects.*.view    # View all projects\ntemplates.*.edit   # Edit all templates\ndeployments.*      # All actions on all deployments\n"})}),"\n",(0,r.jsx)(s.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Principle of Least Privilege"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Assign only necessary permissions"}),"\n",(0,r.jsx)(s.li,{children:"Use specific resource IDs when possible"}),"\n",(0,r.jsx)(s.li,{children:"Avoid wildcard permissions unless required"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Role Design"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Create roles based on job functions"}),"\n",(0,r.jsx)(s.li,{children:"Use meaningful role names"}),"\n",(0,r.jsx)(s.li,{children:"Document role purposes and permissions"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Permission Organization"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Group related permissions"}),"\n",(0,r.jsx)(s.li,{children:"Use consistent naming conventions"}),"\n",(0,r.jsx)(s.li,{children:"Document permission purposes"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Security"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Regularly review permissions"}),"\n",(0,r.jsx)(s.li,{children:"Remove unused permissions"}),"\n",(0,r.jsx)(s.li,{children:"Audit permission changes"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"examples",children:"Examples"}),"\n",(0,r.jsx)(s.h3,{id:"basic-permission-examples",children:"Basic Permission Examples"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-php",children:"// UI Permissions\n'projects.view'                                            // View projects list via GUI or API\n'templates.create'                                         // Create new templates via GUI or API\n'deployments.b1c7ef32-f846-47a2-bdaf-62fdce11b170.edit'    // Edit specific deployment via GUI or API\n"})}),"\n",(0,r.jsx)(s.h3,{id:"role-definition-example",children:"Role Definition Example"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-php",children:"// Admin Role\n[\n    '*',                // All permissions\n]\n\n// Template Manager Role\n[\n    'templates.*',   // All template management\n]\n\n// Project Manager Role\n[\n    'projects.*',    // View all projects\n]\n"})}),"\n",(0,r.jsx)(s.h2,{id:"api-permissions-1",children:"API Permissions"}),"\n",(0,r.jsx)(s.p,{children:"API permissions follow the same structure but with additional security measures:"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Token Validation"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"API tokens are required"}),"\n",(0,r.jsx)(s.li,{children:"Tokens are associated with specific permissions"}),"\n",(0,r.jsx)(s.li,{children:"Tokens can be scoped to specific resources"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Rate Limiting"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"API requests are rate-limited"}),"\n",(0,r.jsx)(s.li,{children:"Limits are configurable per permission"}),"\n",(0,r.jsx)(s.li,{children:"Limits can be customized per role"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Audit Logging"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"All API permission checks are logged"}),"\n",(0,r.jsx)(s.li,{children:"Failed attempts are recorded"}),"\n",(0,r.jsx)(s.li,{children:"Success patterns are monitored"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,r.jsx)(s.p,{children:"Common permission issues and solutions:"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Permission Denied"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Check user role assignments"}),"\n",(0,r.jsx)(s.li,{children:"Verify permission inheritance"}),"\n",(0,r.jsx)(s.li,{children:"Review resource-specific permissions"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"API Access Issues"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Validate API token"}),"\n",(0,r.jsx)(s.li,{children:"Check token permissions"}),"\n",(0,r.jsx)(s.li,{children:"Verify rate limits"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Permission Sync Problems"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Run permission sync command"}),"\n",(0,r.jsx)(s.li,{children:"Check route definitions"}),"\n",(0,r.jsx)(s.li,{children:"Verify middleware configuration"}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,l.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}}}]);